"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "main";
exports.ids = null;
exports.modules = {

/***/ "./domains/company/graphql/index.ts":
/*!******************************************!*\
  !*** ./domains/company/graphql/index.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports[\"default\"] = \"\\n  type CompanyResponseType {\\n    data: [CompanyType]\\n  }\\n\\n  type ReportByNormType {\\n    value: Float\\n    year: Int\\n    quarter: Int\\n    reportId: Int\\n    normId: Int\\n  }\\n\\n  type CompanyType {\\n    id: Int\\n    code: String\\n    name: String\\n    reports: [ReportByNormType]\\n  }\\n\\n  input NormInput {\\n    id: Int\\n    from: String\\n    to: String\\n  }\\n\\n  input CompanyFilterInput {\\n    years: [Int]\\n    fromValue: String\\n    toValue: String \\n    norms: [NormInput]\\n    quarters: [Int]\\n    reportType: String\\n  }\\n  \\n  type Query {\\n    Companies: [CompanyType]\\n    FilteredCompanies(filters: CompanyFilterInput): CompanyResponseType\\n  }\\n\";\n\n\n//# sourceURL=webpack://tech-challenge/./domains/company/graphql/index.ts?");

/***/ }),

/***/ "./domains/company/resolvers/index.ts":
/*!********************************************!*\
  !*** ./domains/company/resolvers/index.ts ***!
  \********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nvar service_1 = __webpack_require__(/*! ../service */ \"./domains/company/service/index.ts\");\nexports[\"default\"] = {\n    Query: {\n        Companies: function (parent, args, context, info) {\n            return __awaiter(this, void 0, void 0, function () {\n                var _companyService;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            _companyService = new service_1.CompanyService();\n                            return [4 /*yield*/, _companyService.getCompanies()];\n                        case 1: return [2 /*return*/, _a.sent()];\n                    }\n                });\n            });\n        },\n        FilteredCompanies: function (parent, args, context, info) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    context.args = args;\n                    return [2 /*return*/, args];\n                });\n            });\n        },\n    },\n    CompanyResponseType: {\n        data: function (parent, args, context, info) {\n            return __awaiter(this, void 0, void 0, function () {\n                var companyService;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            companyService = new service_1.CompanyService();\n                            return [4 /*yield*/, companyService.getFilteredCompanies(parent.filters, context)];\n                        case 1: return [2 /*return*/, _a.sent()];\n                    }\n                });\n            });\n        },\n    },\n    CompanyType: {\n        reports: function (parent, args, context, info) {\n            return __awaiter(this, void 0, void 0, function () {\n                var companyService;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            companyService = new service_1.CompanyService();\n                            return [4 /*yield*/, companyService.getReportByNorm(parent, args, context, info)];\n                        case 1: return [2 /*return*/, _a.sent()];\n                    }\n                });\n            });\n        },\n    }\n};\n\n\n//# sourceURL=webpack://tech-challenge/./domains/company/resolvers/index.ts?");

/***/ }),

/***/ "./domains/company/service/index.ts":
/*!******************************************!*\
  !*** ./domains/company/service/index.ts ***!
  \******************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.CompanyService = void 0;\nvar company_repo_1 = __webpack_require__(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module '@/repo/company.repo'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()));\nvar dataloader_1 = __importDefault(__webpack_require__(/*! dataloader */ \"dataloader\"));\nvar reports_repo_1 = __webpack_require__(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module '@/repo/reports.repo'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()));\nvar helper_1 = __webpack_require__(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module '@/src/helper'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()));\nvar CompanyService = /** @class */ (function () {\n    function CompanyService() {\n        this._companyRepo = new company_repo_1.CompanyRepo();\n        this._reportsRepo = new reports_repo_1.ReportsRepo();\n        this.createMap = helper_1.createMap;\n    }\n    CompanyService.prototype.addLoaderToContext = function (context, loaderName, loaderFunc) {\n        if (context) {\n            context[loaderName] = new dataloader_1.default(loaderFunc);\n        }\n        return context;\n    };\n    CompanyService.prototype.getLoaders = function (context, filters) {\n        var _this = this;\n        context = this.addLoaderToContext(context, 'reportLoader', function (companyIds) { return __awaiter(_this, void 0, void 0, function () {\n            var normIds, returnData, data, map;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        console.log({ companyIds: companyIds }, 'reportLoader is running ...');\n                        normIds = filters.norms.map(function (item) { return item.id; });\n                        returnData = [];\n                        return [4 /*yield*/, this._reportsRepo.getReportsByCompanyFilter(filters, companyIds, normIds)];\n                    case 1:\n                        data = _a.sent();\n                        map = this.createMap('companyId', data);\n                        companyIds.forEach(function (id) {\n                            returnData.push({ id: id, data: map[id] || [] });\n                        });\n                        return [2 /*return*/, Promise.resolve(returnData)];\n                }\n            });\n        }); });\n    };\n    CompanyService.prototype.getCompanies = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._companyRepo.select()];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    CompanyService.prototype.getFilteredCompanies = function (filters, context) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (filters.norms.length > 0)\n                            context = this.getLoaders(context, filters);\n                        return [4 /*yield*/, this._companyRepo.getFilteredCompanies(filters)];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    CompanyService.prototype.getReportByNorm = function (parent, args, context, info) {\n        return __awaiter(this, void 0, void 0, function () {\n            var reportLoader, reports, err_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 4, , 5]);\n                        reportLoader = context.reportLoader;\n                        if (!(reportLoader && parent.id && context.args.filters.norms.length > 0)) return [3 /*break*/, 2];\n                        return [4 /*yield*/, reportLoader.load(parent.id)];\n                    case 1:\n                        reports = _a.sent();\n                        return [2 /*return*/, reports.data || []];\n                    case 2: return [2 /*return*/, []];\n                    case 3: return [2 /*return*/, []];\n                    case 4:\n                        err_1 = _a.sent();\n                        console.log({ err: err_1 }, 'Failed to run getSkuCodePrices > err');\n                        throw err_1;\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return CompanyService;\n}());\nexports.CompanyService = CompanyService;\n\n\n//# sourceURL=webpack://tech-challenge/./domains/company/service/index.ts?");

/***/ }),

/***/ "./index.ts":
/*!******************!*\
  !*** ./index.ts ***!
  \******************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nvar express_1 = __importDefault(__webpack_require__(/*! express */ \"express\"));\nvar graphql_yoga_1 = __webpack_require__(/*! graphql-yoga */ \"graphql-yoga\");\nvar schema_1 = __webpack_require__(/*! @graphql-tools/schema */ \"@graphql-tools/schema\");\nvar merge_1 = __webpack_require__(/*! @graphql-tools/merge */ \"@graphql-tools/merge\");\nvar index_1 = __importDefault(__webpack_require__(/*! domains/company/graphql/index */ \"./domains/company/graphql/index.ts\"));\nvar index_2 = __importDefault(__webpack_require__(/*! ./domains/company/resolvers/index */ \"./domains/company/resolvers/index.ts\"));\nvar executableSchema = (0, schema_1.makeExecutableSchema)({\n    typeDefs: [index_1.default],\n    resolvers: (0, merge_1.mergeResolvers)([index_2.default]),\n});\n// const server = createServer({\n//   schema: executableSchema,\n//   endpoint: \"/api/graphql\",\n//   graphiql: true,\n// });\n// export default server;\nvar app = (0, express_1.default)();\nvar yoga = (0, graphql_yoga_1.createYoga)({ schema: executableSchema });\n// Bind GraphQL Yoga to the graphql endpoint to avoid rendering the playground on any path\napp.use(yoga.graphqlEndpoint, yoga);\napp.listen(4000, function () {\n    console.log('Running a GraphQL API server at http://localhost:4000/graphql');\n});\n// const express = require('express')\n// const { graphqlHTTP } = require('express-graphql')\n// const graphql = require('graphql')\n// const joinMonster = require('join-monster').default;\n// // Connect to database\n// const config = {\n//   client: 'postgres',\n//   connection: {\n//     host: 'localhost',\n//     user: 'test',\n//     password: 'test',\n//     database: 'harvest'\n//   }\n// }\n// const knex = require('knex')(config);\n// // Define the schema\n// const Device = new graphql.GraphQLObjectType({\n//   name: 'Device',\n//   extensions: {\n//     joinMonster: {\n//       sqlTable: 'device',\n//       uniqueKey: 'id'\n//     }\n//   },\n//   fields: () => ({\n//     id: { type: graphql.GraphQLString },\n//     name: { type: graphql.GraphQLString },\n//   })\n// });\n// const MutationRoot = new graphql.GraphQLObjectType({\n//   name: 'Mutation',\n//   fields: () => ({\n//     device: {\n//       type: Device,\n//       args: {\n//         name: { type: graphql.GraphQLNonNull(graphql.GraphQLString) },\n//       },\n//     }\n//   })\n// })\n// const QueryRoot = new graphql.GraphQLObjectType({\n//   name: 'Query',\n//   fields: () => ({\n//     devices: {\n//       type: new graphql.GraphQLList(Device),\n//       resolve: (parent, args, context, resolveInfo) => {\n//         return joinMonster(resolveInfo, {}, sql => {\n//           console.log(sql);\n//           return knex.raw(sql)\n//         })\n//       }\n//     },\n//     device: {\n//       type: Device,\n//       args: { id: { type: graphql.GraphQLNonNull(graphql.GraphQLInt) } },\n//       where: (deviceTable, args, context) => `${deviceTable}.id = ${args.id}`,\n//       resolve: (parent, args, context, resolveInfo) => {\n//         return joinMonster(resolveInfo, {}, sql => {\n//           console.log(sql);\n//           return knex.raw(sql)\n//         })\n//       }\n//     },\n//   })\n// })\n// const schema = new graphql.GraphQLSchema({\n//   query: QueryRoot,\n//   mutation: MutationRoot\n// });\n// // Create the Express app\n// const app = express();\n// app.use('/api', graphqlHTTP({\n//   schema: schema,\n//   graphiql: true\n// }));\n// console.log(\"running on http://localhost:4000/api\")\n// app.listen(4000);\n\n\n//# sourceURL=webpack://tech-challenge/./index.ts?");

/***/ }),

/***/ "dataloader":
/*!*****************************!*\
  !*** external "dataloader" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("dataloader");

/***/ })

};
exports.runtime =
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("2916dc48f6b58a9ec8b2")
/******/ })();
/******/ 
/******/ }
;